<!DOCTYPE html>
<html lang="en">
    <%- include('../templates/head', {title: 'Your Orders'}); %>
  <head>
    <meta charset="utf-8">
    <title>Schedule Order and Pay</title>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!--  jQuery -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <!-- Isolated Version of Bootstrap, not needed if your site already uses Bootstrap -->
    <link rel="stylesheet" href="https://formden.com/static/cdn/bootstrap-iso.css" />

    <!-- Bootstrap Date-Picker Plugin -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css"/>

    <link rel="stylesheet" href="public/assets/index.css">

    <script>
        //create an array of dates (reached max deliverys) to exclude from the calendar
        var dateArray = [];
        //Year, Month, Date
        var date1 = new Date("04/21/2017");
        var date2 = new Date("04/25/2017");
        var todaysDate = new Date();

        dateArray.push(date1);
        dateArray.push(date2);


        $(document).ready(function(){
          var date_input=$('input[name="date"]'); //our date input has the name "date"
          var container=$('.bootstrap-iso form').length>0 ? $('.bootstrap-iso form').parent() : "body";
          var options={
            format: 'mm/dd/yyyy',
            container: container,
            todayHighlight: true,
            autoclose: true,
            daysOfWeekDisabled: [0, 6],
            disabledDates: ['2017-04-21', '2017-04-25'],
            startDate: todaysDate,
          };
          date_input.datepicker(options);
        });
    </script>
<script>
$(document).ready(function () {
    $('.recurrenceDD').hide();
    $('#recurringCB').click(function () {
      console.log('recurrenceCB clicked')
        $( ".recurrenceDD" ).show( "slow", function() {
        });
    });
});
</script>






<script>
//The action for the submit button
//Gathers the schedule date and the status of the recurring delivery
//checkbox and the value of the schedule dropdown
function sendOrderToRoute(){
      var schedDate = $('.datePickerText').val();
      //var recurring = $('#recurringCB')[0].checked;
      //var ddVal = $('#recurrenceDD :selected').text();

      if(!schedDate){
        alert("Please schedule a delivery date");
      }
      console.log("Local Storage.cart", JSON.parse(localStorage.cart))

      var order = {
        'menuItemID': JSON.parse(localStorage.cart)[0].id,
        'quantity': JSON.parse(localStorage.cart)[0].quantity,
        'item_price': JSON.parse(localStorage.cart)[0].item_price,
        'schedDate': schedDate//,
        //'recurring': recurring,
        //'frequency': ddVal
      };

      console.log('view order = ', order);

      //ajax call to the appropriate route
      var request = $.ajax({
        url: "http://localhost:3000/orders",
        method: "POST",
        data: order,
        dataType: "json"
      });
    };
</script>

  </head>
  <body>
    <%- include('../templates/navbar'); %>


    <div>
      <p>
        Data Here.
      </p>
      <p>
        Data Here.
      </p>
      <p>
        Data Here.
      </p>
      <p>
        Data Here.
      </p>
      <p>
        Data Here.
      </p>


    </div>



      <div class="bootstrap-iso">
       <div class="container-fluid">
        <div class="row">
         <div class="col-md-6 col-sm-6 col-xs-12">
           <div class="datePicker">
             <label class="datePickerLabel" for="date">Delivery Date:</label>
             <input class="datePickerText" id="dateText" name="date" placeholder="MM/DD/YYY" type="text"/>
           </div>
          </div>
        </div>
       </div>
      </div>
      <div class="row">
  <!-- <div class="col-lg-6">
    <div class="input-group">
      <span class="recurringCBGroup">
        <label for="recurringCB">Recurring Order?</label>
        <input id= "recurringCB" value="recurringCB" type="checkbox" aria-label="...">
      </span>
    </div>


  </div>
</div>

<!-- <div class="recurrenceDD" id="recurrenceDD">
  <select id="dropdown-menu">
    <option value='Weekly'>Weekly</option>
    <option value='Bi-Weekly'>Bi-Weekly</option>
    <option value='Monthly'>Monthly</option>
  </select>
</div> -->

<div class="form-group"> <!-- Submit button -->
  <input type="button" value="Submit Order" onclick="sendOrderToRoute()"></button>
</div>
    <!-- </form> -->

  </body>
</html>
